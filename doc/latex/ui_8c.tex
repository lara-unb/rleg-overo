\hypertarget{ui_8c}{
\section{ui.c File Reference}
\label{ui_8c}\index{ui.c@{ui.c}}
}
{\ttfamily \#include $<$ncurses.h$>$}\par
{\ttfamily \#include $<$math.h$>$}\par
{\ttfamily \#include $<$string.h$>$}\par
{\ttfamily \#include \char`\"{}communication/communication.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}datalogger.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}main2.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}ui.h\char`\"{}}\par
Include dependency graph for ui.c:\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{ui_8c_a5f05ce725141ddfab683e059b1cd95ea}{exit\_\-program} (void)
\begin{DoxyCompactList}\small\item\em Internal function to end program. \item\end{DoxyCompactList}\item 
int \hyperlink{group__ui_gab7bfb453918dcc296ff0cea3c79453d0}{ui\_\-init} (void)
\begin{DoxyCompactList}\small\item\em Initialize UI. \item\end{DoxyCompactList}\item 
int \hyperlink{group__ui_ga65d8b92b634da17c344458cd57e61f3e}{ui\_\-close} (void)
\begin{DoxyCompactList}\small\item\em Close UI. \item\end{DoxyCompactList}\item 
int \hyperlink{group__ui_ga42e4dac2d138061a74c572358c8ebf49}{ui\_\-update} (\hyperlink{structIMU__DATA__STRUCT}{IMU\_\-DATA\_\-STRUCT} $\ast$pimu\_\-data, \hyperlink{structEFF__DATA__STRUCT}{EFF\_\-DATA\_\-STRUCT} $\ast$peff\_\-data, \hyperlink{structMRA__DATA__STRUCT}{MRA\_\-DATA\_\-STRUCT} $\ast$pmra\_\-data, \hyperlink{structENC__DATA__STRUCT}{ENC\_\-DATA\_\-STRUCT} $\ast$\hyperlink{main2_8c_aaa441e18ae805c4f3efb0b5231d1cfe7}{enc\_\-data}, int \hyperlink{threads__linux_8c_ac7af894858cf396a219d632f40afdc8d}{total}, int \hyperlink{threads__linux_8c_a4f35e5ea2395561d0bd3b2f45612dc2c}{failure})
\begin{DoxyCompactList}\small\item\em Update Screen with new data of sensors. \item\end{DoxyCompactList}\item 
int \hyperlink{group__ui_ga7d5a9d9a75693709de408781d001a6a6}{ui\_\-imu\_\-data} (\hyperlink{structIMU__DATA__STRUCT}{IMU\_\-DATA\_\-STRUCT} $\ast$pimu\_\-data)
\begin{DoxyCompactList}\small\item\em Print IMU data. \item\end{DoxyCompactList}\item 
int \hyperlink{ui_8c_af48496a4ce54378764bc4ca9eddfd498}{ui\_\-eff\_\-data} (\hyperlink{structEFF__DATA__STRUCT}{EFF\_\-DATA\_\-STRUCT} $\ast$peff\_\-data)
\item 
int \hyperlink{ui_8c_a3821f6ba38465f8d170f7b947869e7d9}{ui\_\-enc\_\-data} (\hyperlink{structENC__DATA__STRUCT}{ENC\_\-DATA\_\-STRUCT} $\ast$\hyperlink{main2_8c_aaa441e18ae805c4f3efb0b5231d1cfe7}{enc\_\-data})
\begin{DoxyCompactList}\small\item\em Print ENCODER data. \item\end{DoxyCompactList}\item 
int \hyperlink{group__ui_gaefec243c5df45db0350c1abbccf20e3b}{ui\_\-mra\_\-data} (\hyperlink{structMRA__DATA__STRUCT}{MRA\_\-DATA\_\-STRUCT} $\ast$pmra\_\-data)
\begin{DoxyCompactList}\small\item\em Print MRA data. \item\end{DoxyCompactList}\item 
int \hyperlink{ui_8c_a8d5e19833fec51919aad6e78bb74619a}{ui\_\-overview\_\-data} (int \hyperlink{threads__linux_8c_ac7af894858cf396a219d632f40afdc8d}{total}, int failures, \hyperlink{structIMU__DATA__STRUCT}{IMU\_\-DATA\_\-STRUCT} $\ast$pimu\_\-data, \hyperlink{structEFF__DATA__STRUCT}{EFF\_\-DATA\_\-STRUCT} $\ast$peff\_\-data, \hyperlink{structMRA__DATA__STRUCT}{MRA\_\-DATA\_\-STRUCT} $\ast$pmra\_\-data, \hyperlink{structENC__DATA__STRUCT}{ENC\_\-DATA\_\-STRUCT} $\ast$\hyperlink{main2_8c_aaa441e18ae805c4f3efb0b5231d1cfe7}{enc\_\-data})
\begin{DoxyCompactList}\small\item\em Print ALL sensors data. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
unsigned int \hyperlink{ui_8c_a5045187bb0afe92c41ce73bc602fd3ca}{telemetry\_\-mode}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{ui_8c_a5f05ce725141ddfab683e059b1cd95ea}{
\index{ui.c@{ui.c}!exit\_\-program@{exit\_\-program}}
\index{exit\_\-program@{exit\_\-program}!ui.c@{ui.c}}
\subsubsection[{exit\_\-program}]{\setlength{\rightskip}{0pt plus 5cm}void exit\_\-program (void)}}
\label{ui_8c_a5f05ce725141ddfab683e059b1cd95ea}


Internal function to end program. 



Definition at line 135 of file main.c.



References quittask.



Referenced by ui\_\-update().




\begin{DoxyCode}
135                        {
136   quittask = 1;
137   return;
138 }
\end{DoxyCode}




Here is the caller graph for this function:

\hypertarget{ui_8c_af48496a4ce54378764bc4ca9eddfd498}{
\index{ui.c@{ui.c}!ui\_\-eff\_\-data@{ui\_\-eff\_\-data}}
\index{ui\_\-eff\_\-data@{ui\_\-eff\_\-data}!ui.c@{ui.c}}
\subsubsection[{ui\_\-eff\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}int ui\_\-eff\_\-data ({\bf EFF\_\-DATA\_\-STRUCT} $\ast$ {\em peff\_\-data})}}
\label{ui_8c_af48496a4ce54378764bc4ca9eddfd498}


Definition at line 158 of file ui.c.



References EFF\_\-DATA\_\-STRUCT::F, EFF\_\-DATA\_\-STRUCT::M, SUCCESS, DATA\_\-XYZ::x, DATA\_\-XYZ::y, and DATA\_\-XYZ::z.



Referenced by ui\_\-update().




\begin{DoxyCode}
159 {
160         mvprintw(2,0,"Fx (bits): %d",peff_data->F.x);
161         //mvprintw(2,40,"Fx (N): %lf",peff_data->??);
162         mvprintw(3,0,"Fy (bits): %d",peff_data->F.y);
163         //mvprintw(3,40,"Fx (N): %lf",peff_data->??);
164         mvprintw(4,0,"Fz (bits): %d",peff_data->F.z);
165         //mvprintw(4,40,"Fx (N): %lf",peff_data->??);
166         mvprintw(5,0,"Mx (bits): %d",peff_data->M.x);
167         //mvprintw(5,40,"Mx (Nm): %lf",peff_data->??);
168         mvprintw(6,0,"My (bits): %d",peff_data->M.y);
169         //mvprintw(6,40,"My (Nm): %lf",peff_data->??);
170         mvprintw(7,0,"Mz (bits): %d",peff_data->M.z);
171         //mvprintw(7,40,"Mz (Nm): %lf",peff_data->??);
172 
173         return SUCCESS;
174 }
\end{DoxyCode}




Here is the caller graph for this function:

\hypertarget{ui_8c_a3821f6ba38465f8d170f7b947869e7d9}{
\index{ui.c@{ui.c}!ui\_\-enc\_\-data@{ui\_\-enc\_\-data}}
\index{ui\_\-enc\_\-data@{ui\_\-enc\_\-data}!ui.c@{ui.c}}
\subsubsection[{ui\_\-enc\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}int ui\_\-enc\_\-data ({\bf ENC\_\-DATA\_\-STRUCT} $\ast$ {\em enc\_\-data})}}
\label{ui_8c_a3821f6ba38465f8d170f7b947869e7d9}


Print ENCODER data. 



Definition at line 176 of file ui.c.



References ENC\_\-DATA\_\-STRUCT::calib, ENC\_\-DATA\_\-STRUCT::calibrate::position, ENC\_\-DATA\_\-STRUCT::position, and SUCCESS.



Referenced by ui\_\-update().




\begin{DoxyCode}
177 {
178    mvprintw(2,0,"Position (raw): %lf",enc_data->position);
179    mvprintw(3,0,"Position (degree): %lf",enc_data->calib.position);
180    return SUCCESS;
181 }
\end{DoxyCode}




Here is the caller graph for this function:

\hypertarget{ui_8c_a8d5e19833fec51919aad6e78bb74619a}{
\index{ui.c@{ui.c}!ui\_\-overview\_\-data@{ui\_\-overview\_\-data}}
\index{ui\_\-overview\_\-data@{ui\_\-overview\_\-data}!ui.c@{ui.c}}
\subsubsection[{ui\_\-overview\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}int ui\_\-overview\_\-data (int {\em total}, \/  int {\em failures}, \/  {\bf IMU\_\-DATA\_\-STRUCT} $\ast$ {\em pimu\_\-data}, \/  {\bf EFF\_\-DATA\_\-STRUCT} $\ast$ {\em peff\_\-data}, \/  {\bf MRA\_\-DATA\_\-STRUCT} $\ast$ {\em pmra\_\-data}, \/  {\bf ENC\_\-DATA\_\-STRUCT} $\ast$ {\em enc\_\-data})}}
\label{ui_8c_a8d5e19833fec51919aad6e78bb74619a}


Print ALL sensors data. 



Definition at line 192 of file ui.c.



References IMU\_\-DATA\_\-STRUCT::calibrated::acc, IMU\_\-DATA\_\-STRUCT::acc, ENC\_\-DATA\_\-STRUCT::calib, IMU\_\-DATA\_\-STRUCT::calib, IMU\_\-DATA\_\-STRUCT::calib\_\-temp, get\_\-time(), IMU\_\-DATA\_\-STRUCT::calibrated::gyr, IMU\_\-DATA\_\-STRUCT::gyr, IMU\_\-DATA\_\-STRUCT::calibrated::mag, IMU\_\-DATA\_\-STRUCT::mag, ENC\_\-DATA\_\-STRUCT::calibrate::position, ENC\_\-DATA\_\-STRUCT::position, SUCCESS, t0, IMU\_\-DATA\_\-STRUCT::temp, MRA\_\-DATA\_\-STRUCT::v\_\-ctl, MRA\_\-DATA\_\-STRUCT::v\_\-ctl\_\-read, DATA\_\-XYZ\_\-DOUBLE::x, DATA\_\-XYZ::x, DATA\_\-XYZ\_\-DOUBLE::y, DATA\_\-XYZ::y, DATA\_\-XYZ\_\-DOUBLE::z, and DATA\_\-XYZ::z.



Referenced by ui\_\-update().




\begin{DoxyCode}
193 {
194         float error_rate = 0.0;
195         double t = 0.0;
196         double Ts = 0.0;
197         double mean_exec_time = 0.0;
198         double t0 = 0.0;
199 
200         get_time(&t, &Ts, &mean_exec_time, &t0);
201 
202         error_rate = (float)(((float)failures/(float)total)*100.0);
203         mvprintw(2, 0, "Communication Statistics: Total = %d Failures = %d Error 
      Rate = %3.3f",total, failures, error_rate);
204 
205         mvprintw(4, 0,  "IMU Accelerometer (bits):\tX:%4d\tY:%4d\tZ:%4d", pimu_da
      ta->acc.x, pimu_data->acc.y, pimu_data->acc.z);
206         mvprintw(5, 0, "IMU Gyrometer (bits):\t\tX:%4d\tY:%4d\tZ:%4d", pimu_data-
      >gyr.x, pimu_data->gyr.y, pimu_data->gyr.z);
207         mvprintw(6, 0, "IMU Magnetometer (bits):\tX:%4d\tY:%4d\tZ:%4d", pimu_data
      ->mag.x, pimu_data->mag.y, pimu_data->mag.z);
208         
209         mvprintw(8, 0,  "IMU Accelerometer (g):\t\tX:%8.5lf\tY:%8.5lf\tZ:%8.5lf",
       pimu_data->calib.acc.x, pimu_data->calib.acc.y, pimu_data->calib.acc.z);
210         mvprintw(9, 0, "IMU Gyrometer (rad/s):\t\tX:%8.5lf\tY:%8.5lf\tZ:%8.5lf", 
      pimu_data->calib.gyr.x, pimu_data->calib.gyr.y, pimu_data->calib.gyr.z);
211         mvprintw(10, 0, "IMU Magnetometer (B):\t\tX:%8.5lf\tY:%8.5lf\tZ:%8.5lf", 
      pimu_data->calib.mag.x, pimu_data->calib.mag.y, pimu_data->calib.mag.z);
212 
213         mvprintw(12, 0, "Temp (bits):\t%d", pimu_data->temp);
214         mvprintw(12,40, "Temp (ÂºC):\t%lf", pimu_data->calib_temp);
215 
216         mvprintw(13,0, "Encoder (bits):\t%d",enc_data->position);
217         mvprintw(13,40, "Encoder (degree):\t%d",enc_data->calib.position);
218         //mvprintw(15,0,"Fx (bits): %d",peff_data->F.x);
219 
220         //mvprintw(2,40,"Fx (N): %lf",peff_data->??);
221         //mvprintw(15,0,"Fy (bits): %d",peff_data->F.y);
222         //mvprintw(3,40,"Fx (N): %lf",peff_data->??);
223         //mvprintw(16,0,"Fz (bits): %d",peff_data->F.z);
224         //mvprintw(4,40,"Fx (N): %lf",peff_data->??);
225         //mvprintw(17,0,"Mx (bits): %d",peff_data->M.x);
226         //mvprintw(5,40,"Mx (Nm): %lf",peff_data->??);
227         //mvprintw(18,0,"My (bits): %d",peff_data->M.y);
228         //mvprintw(6,40,"My (Nm): %lf",peff_data->??);
229         //mvprintw(19,0,"Mz (bits): %d",peff_data->M.z);
230         //mvprintw(7,40,"Mz (Nm): %lf",peff_data->??);
231         
232         mvprintw(15, 0, "Voltage Control Written (bits):\t%4d", pmra_data->v_ctl)
      ;
233         mvprintw(16, 0, "Voltage Control Read (bits):\t%4d", pmra_data->
      v_ctl_read);
234 
235     mvprintw(18, 0, "Runtime: %4.2lf", t);
236     //removed datalogger:
237     if(1)//if(datalogger_status() == DATALOGGER_NOT_RUNNING)
238     {
239         mvprintw(18, 40, "Datalogger stopped");
240     }
241     else
242     {
243         mvprintw(18, 40, "Datalogger runtime: %4.2lf", (t-t0));
244     }
245 /*
246     if(calibration_get_status() == CALIBRATION_NOT_RUNNING)
247     {
248         mvprintw(15, 0, "Calibration stopped");
249     }
250     else
251     {
252         mvprintw(15, 0, "Calibration running");
253     }
254 */
255         mvprintw(20, 0, "I: IMU");
256         mvprintw(20, 20, "F: Efforts");
257         mvprintw(20, 40, "M: Magneto-rheological Actuator");
258         mvprintw(21, 0, "E: Encoder");
259         mvprintw(21, 20, "O: Overview");
260         //mvprintw(21, 40, "D: Datalogger Start/Stop");
261         mvprintw(22, 0, "Q: Quit\n");
262 
263         return SUCCESS;
264 }
\end{DoxyCode}




Here is the call graph for this function:



Here is the caller graph for this function:



\subsection{Variable Documentation}
\hypertarget{ui_8c_a5045187bb0afe92c41ce73bc602fd3ca}{
\index{ui.c@{ui.c}!telemetry\_\-mode@{telemetry\_\-mode}}
\index{telemetry\_\-mode@{telemetry\_\-mode}!ui.c@{ui.c}}
\subsubsection[{telemetry\_\-mode}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int {\bf telemetry\_\-mode}}}
\label{ui_8c_a5045187bb0afe92c41ce73bc602fd3ca}


Definition at line 65 of file main2.c.



Referenced by periodic\_\-task\_\-2(), and threads\_\-linux\_\-periodic\_\-task\_\-2().

