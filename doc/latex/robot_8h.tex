\hypertarget{robot_8h}{\section{schunk\-\_\-high/include/schunk\-\_\-high/robot.h File Reference}
\label{robot_8h}\index{schunk\-\_\-high/include/schunk\-\_\-high/robot.\-h@{schunk\-\_\-high/include/schunk\-\_\-high/robot.\-h}}
}
{\ttfamily \#include \char`\"{}link.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gmatrix.\-h\char`\"{}}\\*
Include dependency graph for robot.\-h\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=225pt]{robot_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structRobot}{Robot}
\begin{DoxyCompactList}\small\item\em The Structure holding the relevant info of a \hyperlink{structRobot}{Robot}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structRobot}{Robot} $\ast$ \hyperlink{robot_8h_a5f12182c82371c83a3e31f88b61633ea}{Robot\-\_\-create} (void)
\begin{DoxyCompactList}\small\item\em Allocates and Initializes a \hyperlink{structRobot}{Robot}'s variables. \end{DoxyCompactList}\item 
void \hyperlink{robot_8h_a31f8aee15b6c24f89ab51b1bc1341f33}{Robot\-\_\-free} (\hyperlink{structRobot}{Robot} $\ast$r)
\begin{DoxyCompactList}\small\item\em Frees a \hyperlink{structRobot}{Robot} and all its Links. \end{DoxyCompactList}\item 
void \hyperlink{robot_8h_a030c05a337b160cdbf4d98c458bda2ed}{Robot\-\_\-add\-Link} (\hyperlink{structRobot}{Robot} $\ast$r, double theta, double d, double a, double alpha)
\begin{DoxyCompactList}\small\item\em Adds a \hyperlink{structLink}{Link} to a given robot. \end{DoxyCompactList}\item 
\hyperlink{structDQ}{D\-Q} $\ast$ \hyperlink{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c}{Robot\-\_\-\-F\-K\-M} (\hyperlink{structRobot}{Robot} $\ast$r)
\begin{DoxyCompactList}\small\item\em Finds the Dual\-Quaternion that represents the End Effector's pose using the Foward Kinematics D\-H Model. \end{DoxyCompactList}\item 
\hyperlink{structLink}{Link} $\ast$ \hyperlink{robot_8h_af34bf204faed7e475a004f0c027badcc}{Robot\-\_\-get\-Link} (\hyperlink{structRobot}{Robot} $\ast$r, int i)
\begin{DoxyCompactList}\small\item\em Gets a \hyperlink{structLink}{Link} by it's index. \end{DoxyCompactList}\item 
\hyperlink{gmatrix_8h_ad8edc274a17feb9e4fca93e620253bed}{P\-G\-M\-A\-T\-R\-I\-X} \hyperlink{robot_8h_ab6dd42296709cf38d3468af7afd29563}{Robot\-\_\-get\-A\-Jacobian} (\hyperlink{structRobot}{Robot} $\ast$r)
\begin{DoxyCompactList}\small\item\em Returns the (Analytical) Dual\-Quaternion Jacobian. \end{DoxyCompactList}\item 
\hyperlink{gmatrix_8h_ad8edc274a17feb9e4fca93e620253bed}{P\-G\-M\-A\-T\-R\-I\-X} \hyperlink{robot_8h_a61464c237c56f3db3f79b0350df80ddb}{Robot\-\_\-get\-G\-Jacobian} (\hyperlink{structRobot}{Robot} $\ast$r)
\begin{DoxyCompactList}\small\item\em Returns the (Geometrical) Dual\-Quaternion Jacobian. \end{DoxyCompactList}\item 
\hyperlink{gmatrix_8h_ad8edc274a17feb9e4fca93e620253bed}{P\-G\-M\-A\-T\-R\-I\-X} \hyperlink{robot_8h_ae6858f6a120e4ce01df49d39cef2c164}{Robot\-\_\-get\-O\-Jacobian\-Angle\-P} (\hyperlink{structRobot}{Robot} $\ast$r)
\begin{DoxyCompactList}\small\item\em Returns the (Orientation) Dual\-Quaternion Jacobian for the P angle. \end{DoxyCompactList}\item 
int \hyperlink{robot_8h_aa1d3aca5132bd5f347f5966d38fbb966}{Robot\-\_\-update\-Links\-Thetas\-By\-Matrix} (\hyperlink{structRobot}{Robot} $\ast$r, \hyperlink{gmatrix_8h_ad8edc274a17feb9e4fca93e620253bed}{P\-G\-M\-A\-T\-R\-I\-X} thetas)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{robot_8h_a030c05a337b160cdbf4d98c458bda2ed}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-add\-Link@{Robot\-\_\-add\-Link}}
\index{Robot\-\_\-add\-Link@{Robot\-\_\-add\-Link}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-add\-Link}]{\setlength{\rightskip}{0pt plus 5cm}void Robot\-\_\-add\-Link (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r, }
\item[{double}]{theta, }
\item[{double}]{d, }
\item[{double}]{a, }
\item[{double}]{alpha}
\end{DoxyParamCaption}
)}}\label{robot_8h_a030c05a337b160cdbf4d98c458bda2ed}


Adds a \hyperlink{structLink}{Link} to a given robot. 


\begin{DoxyParams}{Parameters}
{\em r} & The \hyperlink{structRobot}{Robot}. \\
\hline
{\em theta} & \hyperlink{structLink}{Link}'s D\-H's theta. \\
\hline
{\em d} & \hyperlink{structLink}{Link}'s D\-H's d. \\
\hline
{\em a} & \hyperlink{structLink}{Link}'s D\-H's a. \\
\hline
{\em alpha} & \hyperlink{structLink}{Link}'s D\-H's theta. \\
\hline
\end{DoxyParams}


Definition at line 69 of file robot.\-c.



References Robot\-::dofs, Robot\-::fl, Link\-\_\-create(), and Link\-::n.



Referenced by main(), and Main\-\_\-robot\-\_\-init().


\begin{DoxyCode}
69                                                                            \{
70         \hyperlink{structLink}{Link}* i;
71         \hyperlink{structLink}{Link}* l;
72 
73         r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs}++;
74         
75         l = \hyperlink{link_8h_ace12847e227555949ca7bad31ada29c1}{Link\_create}(theta,d,a,alpha);
76         
77         \textcolor{keywordflow}{if}(r->\hyperlink{structRobot_aa983a42f95f55c494fd4154c4d42be47}{fl} == NULL)\{
78                 r->\hyperlink{structRobot_aa983a42f95f55c494fd4154c4d42be47}{fl} = l;
79         \}
80         \textcolor{keywordflow}{else}\{
81                 \textcolor{keywordflow}{for}(i = r->\hyperlink{structRobot_aa983a42f95f55c494fd4154c4d42be47}{fl}; i->\hyperlink{structLink_a185503cf680f8e9395c19c0521997c5c}{n} != NULL; i = i->\hyperlink{structLink_a185503cf680f8e9395c19c0521997c5c}{n});     
82                 i->\hyperlink{structLink_a185503cf680f8e9395c19c0521997c5c}{n} = l;
83         \}
84 
85 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{robot_8h_a030c05a337b160cdbf4d98c458bda2ed_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_a030c05a337b160cdbf4d98c458bda2ed_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_a5f12182c82371c83a3e31f88b61633ea}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-create@{Robot\-\_\-create}}
\index{Robot\-\_\-create@{Robot\-\_\-create}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-create}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Robot}$\ast$ Robot\-\_\-create (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{robot_8h_a5f12182c82371c83a3e31f88b61633ea}


Allocates and Initializes a \hyperlink{structRobot}{Robot}'s variables. 

\begin{DoxyReturn}{Returns}
A initialized robot with zero degrees of freedom and no Links. 
\end{DoxyReturn}


Definition at line 39 of file robot.\-c.



References Robot\-::dofs, and Robot\-::fl.



Referenced by main().


\begin{DoxyCode}
39                          \{
40         
41         \hyperlink{structRobot}{Robot}* r = (\hyperlink{structRobot}{Robot}*)malloc(\textcolor{keyword}{sizeof}(\hyperlink{structRobot}{Robot}));
42         
43         r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs} = 0;
44         r->\hyperlink{structRobot_aa983a42f95f55c494fd4154c4d42be47}{fl} = NULL; 
45         
46         \textcolor{keywordflow}{return} r;
47 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=230pt]{robot_8h_a5f12182c82371c83a3e31f88b61633ea_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-\-F\-K\-M@{Robot\-\_\-\-F\-K\-M}}
\index{Robot\-\_\-\-F\-K\-M@{Robot\-\_\-\-F\-K\-M}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-\-F\-K\-M}]{\setlength{\rightskip}{0pt plus 5cm}{\bf D\-Q}$\ast$ Robot\-\_\-\-F\-K\-M (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c}


Finds the Dual\-Quaternion that represents the End Effector's pose using the Foward Kinematics D\-H Model. 

The robot should have already been initialized using \hyperlink{robot_8h_a5f12182c82371c83a3e31f88b61633ea}{Robot\-\_\-create()} and the Links should have already been added with \hyperlink{robot_8h_a030c05a337b160cdbf4d98c458bda2ed}{Robot\-\_\-add\-Link()}.


\begin{DoxyParams}{Parameters}
{\em r} & The \hyperlink{structRobot}{Robot} which End Effector's pose is desired. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A Dual\-Quaternion representing its End Effector's pose. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See Also}
\hyperlink{robot_8h_a5f12182c82371c83a3e31f88b61633ea}{Robot\-\_\-create()}. 

\hyperlink{robot_8h_a030c05a337b160cdbf4d98c458bda2ed}{Robot\-\_\-add\-Link()}. 
\end{DoxySeeAlso}


Definition at line 97 of file robot.\-c.



References D\-Q\-\_\-create(), D\-Q\-\_\-mult(), Robot\-::fl, Link\-\_\-\-D\-Q\-F\-T(), Link\-::n, and T\-R\-U\-E.



Referenced by Cartesian\-\_\-pose\-\_\-controller\-::control(), main(), Robot\-\_\-get\-A\-Jacobian(), Robot\-\_\-get\-G\-Jacobian(), and Robot\-\_\-get\-O\-Jacobian\-Angle\-P().


\begin{DoxyCode}
97                       \{
98 
99         \textcolor{comment}{//Iterator}
100         \hyperlink{structLink}{Link}* i = NULL;
101         
102         \textcolor{comment}{//End Effector DualQuaternion Pose}
103         \hyperlink{structDQ}{DQ}* efp = \hyperlink{dualquaternion_8h_a8b1057516bdc2c0cb14127791cf356cf}{DQ\_create}(1,0,0,0,0,0,0,0);
104 
105         \textcolor{comment}{//Goes through each link frame transformation}
106         \textcolor{keywordflow}{for}(i = r->\hyperlink{structRobot_aa983a42f95f55c494fd4154c4d42be47}{fl}; i != NULL; i = i->\hyperlink{structLink_a185503cf680f8e9395c19c0521997c5c}{n})\{
107                 efp = \hyperlink{dualquaternion_8h_a6618a3e5a7446724565f92271068a985}{DQ\_mult}(efp,\hyperlink{link_8h_a214ddb7cd91bd6b6b3a9ee37d1ec5a92}{Link\_DQFT}(i),\hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},\hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
108         \}
109 
110         \textcolor{keywordflow}{return} efp;
111 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_a31f8aee15b6c24f89ab51b1bc1341f33}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-free@{Robot\-\_\-free}}
\index{Robot\-\_\-free@{Robot\-\_\-free}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}void Robot\-\_\-free (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{robot_8h_a31f8aee15b6c24f89ab51b1bc1341f33}


Frees a \hyperlink{structRobot}{Robot} and all its Links. 



Definition at line 52 of file robot.\-c.



References Robot\-::dofs, Link\-\_\-free(), and Robot\-\_\-get\-Link().



Referenced by Cartesian\-\_\-controller\-::control\-Clean\-Up(), and main().


\begin{DoxyCode}
52                          \{
53         \textcolor{keywordtype}{int} i = 0;
54 
55         \textcolor{keywordflow}{for}(i = (r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs} - 1);i>=0;i--)\{
56                 \hyperlink{link_8h_aa5732848aecbf1cb2f8605b2f43aa14e}{Link\_free}(\hyperlink{robot_8h_af34bf204faed7e475a004f0c027badcc}{Robot\_getLink}(r,i));    
57         \}
58         free(r);
59 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{robot_8h_a31f8aee15b6c24f89ab51b1bc1341f33_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_a31f8aee15b6c24f89ab51b1bc1341f33_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_ab6dd42296709cf38d3468af7afd29563}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-get\-A\-Jacobian@{Robot\-\_\-get\-A\-Jacobian}}
\index{Robot\-\_\-get\-A\-Jacobian@{Robot\-\_\-get\-A\-Jacobian}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-get\-A\-Jacobian}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-G\-M\-A\-T\-R\-I\-X} Robot\-\_\-get\-A\-Jacobian (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{robot_8h_ab6dd42296709cf38d3468af7afd29563}


Returns the (Analytical) Dual\-Quaternion Jacobian. 

It uses the current values in the robot's variables.


\begin{DoxyParams}{Parameters}
{\em r} & The robot. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A (8,D\-O\-F\-S) matrix. 
\end{DoxyReturn}


Definition at line 234 of file robot.\-c.



References Robot\-::dofs, D\-Q\-\_\-create(), D\-Q\-\_\-free(), D\-Q\-\_\-mult(), F\-A\-L\-S\-E, Link\-\_\-\-D\-Q\-F\-T(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-A\-L\-L\-O\-C(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-S\-E\-T\-\_\-\-C\-O\-L\-U\-M\-N\-\_\-\-B\-Y\-\_\-\-D\-Q(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-Z\-E\-R\-O\-E\-S(), Robot\-\_\-\-F\-K\-M(), Robot\-\_\-get\-Link(), Robot\-\_\-get\-P(), and T\-R\-U\-E.



Referenced by Cartesian\-\_\-pose\-\_\-controller\-::control(), and Robot\-\_\-get\-O\-Jacobian\-Angle\-P().


\begin{DoxyCode}
234                                      \{
235 
236         \textcolor{keywordtype}{int} i = 0;
237         \textcolor{keywordtype}{int} dofs = r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs};
238         \hyperlink{structDQ}{DQ}* p;
239         \hyperlink{structDQ}{DQ}* efp = NULL;
240         \hyperlink{structDQ}{DQ}* dq = NULL;
241         \hyperlink{structGMATRIX}{PGMATRIX} AJ = NULL;
242 
243         \textcolor{keywordflow}{if}(dofs < 1)\{\textcolor{keywordflow}{return} NULL;\}
244 
245         \textcolor{comment}{//End Effectors Pose.}
246         efp = \hyperlink{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c}{Robot\_FKM}(r);
247         dq = \hyperlink{dualquaternion_8h_a8b1057516bdc2c0cb14127791cf356cf}{DQ\_create}(1,0,0,0,0,0,0,0);
248         \textcolor{comment}{//Initialize Analytical Jacobian}
249         AJ = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(8,dofs);
250         \hyperlink{gmatrix_8h_a9b78ef8288b8e5448313d92d7427366d}{PGMATRIX\_ZEROES}(AJ);
251 
252         \textcolor{keywordflow}{for}(i=0;i<dofs;i++)\{
253                 
254                 p = \hyperlink{robot_8c_a4b3a6e6509133ce5381e387f9e7fea99}{Robot\_getP}(dq);
255                 dq = \hyperlink{dualquaternion_8h_a6618a3e5a7446724565f92271068a985}{DQ\_mult}(dq,\hyperlink{link_8h_a214ddb7cd91bd6b6b3a9ee37d1ec5a92}{Link\_DQFT}(\hyperlink{robot_8h_af34bf204faed7e475a004f0c027badcc}{Robot\_getLink}(r,i)),
      \hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},\hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
256                 p =  \hyperlink{dualquaternion_8h_a6618a3e5a7446724565f92271068a985}{DQ\_mult}(p,efp,\hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},\hyperlink{robot_8c_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
257 
258                 \hyperlink{dualquaternion_8h_a3d48348c3e25d1724058c2cf2364e42e}{PGMATRIX\_SET\_COLUMN\_BY\_DQ}(AJ,i+1,p);   
259                 \hyperlink{dualquaternion_8h_a1d21b6cb665c04de4be5aca50804caf4}{DQ\_free}(p);
260         \}
261 
262         \textcolor{comment}{//Memory usage care}
263         \hyperlink{dualquaternion_8h_a1d21b6cb665c04de4be5aca50804caf4}{DQ\_free}(efp);
264         \hyperlink{dualquaternion_8h_a1d21b6cb665c04de4be5aca50804caf4}{DQ\_free}(dq);
265 
266         \textcolor{keywordflow}{return} AJ;
267 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_ab6dd42296709cf38d3468af7afd29563_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_ab6dd42296709cf38d3468af7afd29563_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_a61464c237c56f3db3f79b0350df80ddb}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-get\-G\-Jacobian@{Robot\-\_\-get\-G\-Jacobian}}
\index{Robot\-\_\-get\-G\-Jacobian@{Robot\-\_\-get\-G\-Jacobian}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-get\-G\-Jacobian}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-G\-M\-A\-T\-R\-I\-X} Robot\-\_\-get\-G\-Jacobian (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{robot_8h_a61464c237c56f3db3f79b0350df80ddb}


Returns the (Geometrical) Dual\-Quaternion Jacobian. 

It uses the current values in the robot's variables. Lines refer to\-: (Vx, Vy, Vz, Wx, Wy, Wz)$^\wedge$\-T


\begin{DoxyParams}{Parameters}
{\em r} & The robot. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A (6,D\-O\-F\-S) matrix. 
\end{DoxyReturn}
... (pe-\/pi)

z\-\_\-(i-\/1)x(pe-\/pi)

Update G\-J

Mem Free 

Definition at line 278 of file robot.\-c.



References Robot\-::dofs, D\-Q\-\_\-create(), D\-Q\-\_\-free(), D\-Q\-\_\-get\-T(), D\-Q\-\_\-mult(), F\-A\-L\-S\-E, Link\-\_\-\-D\-Q\-F\-T(), D\-Q\-::p, P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-A\-L\-L\-O\-C(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-C\-R\-O\-S\-S\-\_\-\-C\-O\-P\-Y(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-D\-A\-T\-A, P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-F\-R\-E\-E(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-Z\-E\-R\-O\-E\-S(), Q\-\_\-free(), Q\-\_\-sub(), Robot\-\_\-\-F\-K\-M(), Robot\-\_\-get\-Link(), T\-R\-U\-E, and Q\-::v.



Referenced by Cartesian\-\_\-velocity\-\_\-controller\-::control(), and main().


\begin{DoxyCode}
278                                      \{
279         \textcolor{keywordtype}{int} i = 0;
280         \textcolor{keywordtype}{int} dofs = r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs};
281         \hyperlink{structGMATRIX}{PGMATRIX} zmat;
282         \hyperlink{structGMATRIX}{PGMATRIX} pepimat;
283         \hyperlink{structGMATRIX}{PGMATRIX} zmatpepimat;
284         \textcolor{keywordtype}{double} n=0,ex=0,ey=0,ez=0;
285         \hyperlink{structQ}{Q}* qpe;        \hyperlink{structQ}{Q}* qpi; \hyperlink{structQ}{Q}* qsub;
286         \hyperlink{structDQ}{DQ}* efp = NULL;\hyperlink{structDQ}{DQ}* dq = NULL;
287         \hyperlink{structGMATRIX}{PGMATRIX} GJ = NULL;
288 
289         \textcolor{keywordflow}{if}(dofs < 1)\{\textcolor{keywordflow}{return} NULL;\}
290 
291         \textcolor{comment}{//End Effector's Pose.}
292         efp = \hyperlink{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c}{Robot\_FKM}(r);
293         \textcolor{comment}{//End Effector's translation.}
294         qpe = \hyperlink{dualquaternion_8h_a80e2f2aded851388d4f18d486a0b9455}{DQ\_getT}(efp);
295         
296         \textcolor{comment}{//DQ\_print(efp);}
297         dq = \hyperlink{dualquaternion_8h_a8b1057516bdc2c0cb14127791cf356cf}{DQ\_create}(1,0,0,0,0,0,0,0);
298         \textcolor{comment}{//GJ = Mat\_zeros(6,dofs);}
299         GJ   = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(6,dofs);
300         \hyperlink{gmatrix_8h_a9b78ef8288b8e5448313d92d7427366d}{PGMATRIX\_ZEROES}(GJ);
301         \textcolor{comment}{//zmat = Mat\_createByArray(3,1,z)}
302         zmat = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(3,1);
303         \textcolor{comment}{//pepimat = Mat\_createByArray(3,1,pepi);}
304         pepimat = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(3,1);
305         zmatpepimat = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(3,1);
306 
307         \textcolor{comment}{//A primeira transforma��o � a do base frame. Do DualQuaternion (1,0,0,0,0,0,0,0) e vai at� o link}
308         \textcolor{comment}{//anterior ao �ltimo.}
309         \textcolor{keywordflow}{for}(i=0;i<(dofs);i++)\{
310                 
311                 \textcolor{comment}{//Define operation}
312                 n = dq->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[0];
313                 ex = dq->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[1];
314                 ey = dq->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[2];
315                 ez = dq->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[3];
316 
317                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmat,1,1) = 2*(ex*ez + n*ey);
318                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmat,2,1) = 2*(ey*ez - n*ex);
319                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmat,3,1) = 2*(n*n + ez*ez) - 1;
320                 \textcolor{comment}{//zmat = Mat\_createByArray(3,1,z);}
323 \textcolor{comment}{}                qpi = \hyperlink{dualquaternion_8h_a80e2f2aded851388d4f18d486a0b9455}{DQ\_getT}(dq);
324                 qsub = \hyperlink{quaternion_8h_aeae0ced4cf7e9771da4b3236b8e5771c}{Q\_sub}(qpe,qpi,\hyperlink{robot_8c_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},\hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
325                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(pepimat,1,1) = qsub->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[1];
326                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(pepimat,2,1) = qsub->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[2];
327                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(pepimat,3,1) = qsub->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[3];
328                 \textcolor{comment}{//pepimat = Mat\_createByArray(3,1,pepi);}
330 \textcolor{comment}{}                \hyperlink{gmatrix_8h_af9c2b665846636801a9b85c22526ff47}{PGMATRIX\_CROSS\_COPY}(zmatpepimat, zmat, pepimat);
331                 \textcolor{comment}{//zmatpepimat = Mat\_crossMult3(zmat,pepimat,TRUE,TRUE);}
333 \textcolor{comment}{}                \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(GJ,1,i+1) = \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmatpepimat,1,1);
334                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(GJ,2,i+1) = \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmatpepimat,2,1);
335                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(GJ,3,i+1) = \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmatpepimat,3,1);
336                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(GJ,4,i+1) = \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmat,1,1);
337                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(GJ,5,i+1) = \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmat,2,1);
338                 \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(GJ,6,i+1) = \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(zmat,3,1);
339                 \textcolor{comment}{//Mat\_setColumnByArray(GJ,i+1,zpepi);}
340                 
342                 \hyperlink{quaternion_8h_a69ecc76f665022f81be1702c20865de4}{Q\_free}(qsub);
343                 dq = \hyperlink{dualquaternion_8h_a6618a3e5a7446724565f92271068a985}{DQ\_mult}(dq,\hyperlink{link_8h_a214ddb7cd91bd6b6b3a9ee37d1ec5a92}{Link\_DQFT}(\hyperlink{robot_8h_af34bf204faed7e475a004f0c027badcc}{Robot\_getLink}(r,i)),
      \hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},\hyperlink{robot_8c_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
344         \}
345 
346         \textcolor{comment}{//Final Mem Free}
347         \hyperlink{quaternion_8h_a69ecc76f665022f81be1702c20865de4}{Q\_free}(qpe);
348         \hyperlink{dualquaternion_8h_a1d21b6cb665c04de4be5aca50804caf4}{DQ\_free}(efp);
349         \hyperlink{dualquaternion_8h_a1d21b6cb665c04de4be5aca50804caf4}{DQ\_free}(dq);
350         \hyperlink{gmatrix_8h_a9a73b4e0a77f386c0bae1bba75298d1d}{PGMATRIX\_FREE}(zmat);
351         \hyperlink{gmatrix_8h_a9a73b4e0a77f386c0bae1bba75298d1d}{PGMATRIX\_FREE}(pepimat);
352         \hyperlink{gmatrix_8h_a9a73b4e0a77f386c0bae1bba75298d1d}{PGMATRIX\_FREE}(zmatpepimat);
353 
354 \textcolor{keywordflow}{return} GJ;
355 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_a61464c237c56f3db3f79b0350df80ddb_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_a61464c237c56f3db3f79b0350df80ddb_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_af34bf204faed7e475a004f0c027badcc}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-get\-Link@{Robot\-\_\-get\-Link}}
\index{Robot\-\_\-get\-Link@{Robot\-\_\-get\-Link}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-get\-Link}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Link}$\ast$ Robot\-\_\-get\-Link (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r, }
\item[{int}]{i}
\end{DoxyParamCaption}
)}}\label{robot_8h_af34bf204faed7e475a004f0c027badcc}


Gets a \hyperlink{structLink}{Link} by it's index. 

Trying to get a \hyperlink{structLink}{Link} from a unitialized pointer leads to an unspecified result.


\begin{DoxyParams}{Parameters}
{\em r} & The \hyperlink{structRobot}{Robot} which Links you want to find. \\
\hline
{\em i} & The index of the \hyperlink{structLink}{Link} (begins on zero and ends in dofs-\/1). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The pointer to the \hyperlink{structLink}{Link} or N\-U\-L\-L if the index is outside the \hyperlink{structRobot}{Robot}'s \hyperlink{structLink}{Link} index range or if r is a N\-U\-L\-L pointer. 
\end{DoxyReturn}


Definition at line 125 of file robot.\-c.



References Robot\-::dofs, Robot\-::fl, and Link\-::n.



Referenced by Robot\-\_\-free(), Robot\-\_\-get\-A\-Jacobian(), and Robot\-\_\-get\-G\-Jacobian().


\begin{DoxyCode}
125                                     \{
126         \textcolor{comment}{//Decl}
127         \hyperlink{structLink}{Link}* l;
128         \textcolor{keywordtype}{int} j = 0;
129 
130 
131         \textcolor{keywordflow}{if}(i < 0 || i >= r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs})\{
132                 \textcolor{keywordflow}{return} NULL;
133         \}
134         \textcolor{keywordflow}{if}(r == NULL)\{
135                 \textcolor{keywordflow}{return} NULL;
136         \}
137 
138         l = r->\hyperlink{structRobot_aa983a42f95f55c494fd4154c4d42be47}{fl};
139         \textcolor{keywordflow}{for}(j = 0; j != i; j++)\{
140                 l = l->\hyperlink{structLink_a185503cf680f8e9395c19c0521997c5c}{n};
141         \}
142         \textcolor{keywordflow}{return} l;
143 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_af34bf204faed7e475a004f0c027badcc_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_ae6858f6a120e4ce01df49d39cef2c164}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-get\-O\-Jacobian\-Angle\-P@{Robot\-\_\-get\-O\-Jacobian\-Angle\-P}}
\index{Robot\-\_\-get\-O\-Jacobian\-Angle\-P@{Robot\-\_\-get\-O\-Jacobian\-Angle\-P}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-get\-O\-Jacobian\-Angle\-P}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-G\-M\-A\-T\-R\-I\-X} Robot\-\_\-get\-O\-Jacobian\-Angle\-P (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{robot_8h_ae6858f6a120e4ce01df49d39cef2c164}


Returns the (Orientation) Dual\-Quaternion Jacobian for the P angle. 

It uses the current values in the robot's variables.


\begin{DoxyParams}{Parameters}
{\em r} & The robot. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A (1,D\-O\-F\-S) matrix. 
\end{DoxyReturn}


Definition at line 366 of file robot.\-c.



References Robot\-::dofs, D\-Q\-\_\-free(), D\-Q\-::p, P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-A\-L\-L\-O\-C(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-C\-O\-P\-Y\-\_\-\-R\-O\-W(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-D\-A\-T\-A, P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-F\-R\-E\-E(), P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-M\-U\-L\-T\-I\-P\-L\-Y\-\_\-\-C\-O\-P\-Y(), Robot\-\_\-\-F\-K\-M(), Robot\-\_\-get\-A\-Jacobian(), and Q\-::v.



Referenced by main().


\begin{DoxyCode}
366                                            \{
367 
368         \hyperlink{structDQ}{DQ}* efp = NULL;
369         \hyperlink{structGMATRIX}{PGMATRIX} AJ = NULL;
370         \hyperlink{structGMATRIX}{PGMATRIX} OJP = NULL;
371         \textcolor{keywordtype}{double} doubleAux = 0;
372         \textcolor{keywordtype}{double} q1,q2,q3,q4;
373         \hyperlink{structGMATRIX}{PGMATRIX} Maux1;
374         \hyperlink{structGMATRIX}{PGMATRIX} Maux2;
375 
376         AJ = \hyperlink{robot_8h_ab6dd42296709cf38d3468af7afd29563}{Robot\_getAJacobian}(r);
377         efp = \hyperlink{robot_8h_a57cc252fbb9e4c8be955b6af755b0c2c}{Robot\_FKM}(r);
378 
379         q1 = efp->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[0];
380         q2 = efp->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[1];
381         q3 = efp->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[2];
382         q4 = efp->\hyperlink{structDQ_a878210bff170f4392d6cbe2d4704ffdc}{p}->\hyperlink{structQ_a2a0074b583999340d42804e4c1141ac4}{v}[3];
383 
384         Maux1 = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(1,4);
385         doubleAux = 2/(sqrt(1-4*pow((q1*q3-q4*q2),2)));
386 
387         \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(Maux1,1,1) =  q3*doubleAux;
388         \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(Maux1,1,2) = -q4*doubleAux;
389         \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(Maux1,1,3) =  q1*doubleAux;
390         \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(Maux1,1,4) = -q2*doubleAux;
391 
392         Maux2 = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(4,r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs});
393 
394         \hyperlink{gmatrix_8h_a60f822f8426a81ffd3a8e5748295f621}{PGMATRIX\_COPY\_ROW}(Maux2, 1, AJ, 1);
395         \hyperlink{gmatrix_8h_a60f822f8426a81ffd3a8e5748295f621}{PGMATRIX\_COPY\_ROW}(Maux2, 2, AJ, 2);
396         \hyperlink{gmatrix_8h_a60f822f8426a81ffd3a8e5748295f621}{PGMATRIX\_COPY\_ROW}(Maux2, 3, AJ, 3);
397         \hyperlink{gmatrix_8h_a60f822f8426a81ffd3a8e5748295f621}{PGMATRIX\_COPY\_ROW}(Maux2, 4, AJ, 4);
398 
399         OJP = \hyperlink{gmatrix_8h_adf8dc9cfae5700de80c88604082ffa10}{PGMATRIX\_ALLOC}(1,r->\hyperlink{structRobot_a51d4a86ac5314a1ed8614d5664c80747}{dofs});
400         \hyperlink{gmatrix_8h_ab8b0e8fdbcef816db4f0c9c235ddfbc8}{PGMATRIX\_MULTIPLY\_COPY}(OJP, Maux1, Maux2);
401 
402         \hyperlink{gmatrix_8h_a9a73b4e0a77f386c0bae1bba75298d1d}{PGMATRIX\_FREE}(Maux1);
403         
404         \hyperlink{gmatrix_8h_a9a73b4e0a77f386c0bae1bba75298d1d}{PGMATRIX\_FREE}(Maux2);
405         
406         \hyperlink{gmatrix_8h_a9a73b4e0a77f386c0bae1bba75298d1d}{PGMATRIX\_FREE}(AJ);
407         
408         \hyperlink{dualquaternion_8h_a1d21b6cb665c04de4be5aca50804caf4}{DQ\_free}(efp);
409 
410         \textcolor{keywordflow}{return} OJP;
411 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_ae6858f6a120e4ce01df49d39cef2c164_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{robot_8h_ae6858f6a120e4ce01df49d39cef2c164_icgraph}
\end{center}
\end{figure}


\hypertarget{robot_8h_aa1d3aca5132bd5f347f5966d38fbb966}{\index{robot.\-h@{robot.\-h}!Robot\-\_\-update\-Links\-Thetas\-By\-Matrix@{Robot\-\_\-update\-Links\-Thetas\-By\-Matrix}}
\index{Robot\-\_\-update\-Links\-Thetas\-By\-Matrix@{Robot\-\_\-update\-Links\-Thetas\-By\-Matrix}!robot.h@{robot.\-h}}
\subsubsection[{Robot\-\_\-update\-Links\-Thetas\-By\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}int Robot\-\_\-update\-Links\-Thetas\-By\-Matrix (
\begin{DoxyParamCaption}
\item[{{\bf Robot} $\ast$}]{r, }
\item[{{\bf P\-G\-M\-A\-T\-R\-I\-X}}]{thetas}
\end{DoxyParamCaption}
)}}\label{robot_8h_aa1d3aca5132bd5f347f5966d38fbb966}


Definition at line 172 of file robot.\-c.



References Robot\-::fl, Link\-::n, P\-G\-M\-A\-T\-R\-I\-X\-\_\-\-D\-A\-T\-A, and Link\-::theta.



Referenced by Cartesian\-\_\-pose\-\_\-controller\-::control(), Cartesian\-\_\-velocity\-\_\-controller\-::control(), and main().


\begin{DoxyCode}
172                                                              \{
173 
174         \textcolor{comment}{//Decl}
175         \hyperlink{structLink}{Link}* l;
176         \textcolor{keywordtype}{int} j = 0;
177 
178         \textcolor{keywordflow}{if}(r == NULL)\{
179                 \textcolor{keywordflow}{return} -1;
180         \}
181         
182         \textcolor{keywordflow}{for}(l = r->\hyperlink{structRobot_aa983a42f95f55c494fd4154c4d42be47}{fl},j=0; l!=NULL; l=l->\hyperlink{structLink_a185503cf680f8e9395c19c0521997c5c}{n},j++)\{
183                 l->\hyperlink{structLink_a88e705bc7fb6c7c8c7fa6987b52667d6}{theta} = \hyperlink{gmatrix_8h_a7333180c47234295df2bd7b09ac00da8}{PGMATRIX\_DATA}(thetas,j+1,1);
184         \}
185         \textcolor{keywordflow}{return} 0;
186 
187 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{robot_8h_aa1d3aca5132bd5f347f5966d38fbb966_icgraph}
\end{center}
\end{figure}


