\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c}{\section{André backup conflitos/spi\-\_\-functions (Cópia em conflito de André Carvalho 2013-\/04-\/26).c File Reference}
\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c}\index{André backup conflitos/spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{André backup conflitos/spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
}
{\ttfamily \#include \char`\"{}spi\-\_\-functions.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aa90cac659d18e8ef6294c7ae337f6b58}{S\-U\-C\-C\-E\-S\-S}~1
\item 
\#define \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a6d58f9ac447476b4e084d7ca383f5183}{F\-A\-I\-L\-U\-R\-E}~0
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort} (const char $\ast$s)
\item 
int \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a70764aca888e93b0329e7a62c9312704}{spi\-\_\-init} (uint8\-\_\-t mode, uint32\-\_\-t speed, uint8\-\_\-t cs)
\item 
void \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a3fb02c6fc5990df81645306a81291624}{spi\-\_\-end} (int \hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\-\_\-dev})
\item 
int \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_ae385345c227d9f67ab490b94ed628988}{adc\-\_\-read} (int \hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\-\_\-dev}, uint8\-\_\-t ch, uint8\-\_\-t sgl, short int $\ast$data)
\item 
uint8\-\_\-t \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a9fe5e6b0c564de89398a80e1689b717f}{dac\-\_\-write} (int \hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\-\_\-dev}, uint8\-\_\-t ch, uint8\-\_\-t \-\_\-shdn, unsigned short int data)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static uint8\-\_\-t \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a46a6da6b1936191571fd30b2a749f38c}{bits} = 8
\item 
static uint16\-\_\-t \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_adc4674f6ea53803d98fa2ec36759e77d}{delay}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a6d58f9ac447476b4e084d7ca383f5183}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!F\-A\-I\-L\-U\-R\-E@{F\-A\-I\-L\-U\-R\-E}}
\index{F\-A\-I\-L\-U\-R\-E@{F\-A\-I\-L\-U\-R\-E}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{F\-A\-I\-L\-U\-R\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-A\-I\-L\-U\-R\-E~0}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a6d58f9ac447476b4e084d7ca383f5183}


Definition at line 8 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by adc\-\_\-read().

\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aa90cac659d18e8ef6294c7ae337f6b58}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!S\-U\-C\-C\-E\-S\-S@{S\-U\-C\-C\-E\-S\-S}}
\index{S\-U\-C\-C\-E\-S\-S@{S\-U\-C\-C\-E\-S\-S}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{S\-U\-C\-C\-E\-S\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-U\-C\-C\-E\-S\-S~1}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aa90cac659d18e8ef6294c7ae337f6b58}


Definition at line 7 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by adc\-\_\-read().



\subsection{Function Documentation}
\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_ae385345c227d9f67ab490b94ed628988}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!adc\-\_\-read@{adc\-\_\-read}}
\index{adc\-\_\-read@{adc\-\_\-read}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{adc\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}int adc\-\_\-read (
\begin{DoxyParamCaption}
\item[{int}]{spi\-\_\-dev, }
\item[{uint8\-\_\-t}]{ch, }
\item[{uint8\-\_\-t}]{sgl, }
\item[{short int $\ast$}]{data}
\end{DoxyParamCaption}
)}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_ae385345c227d9f67ab490b94ed628988}


Definition at line 168 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by main(), and read\-\_\-all\-\_\-data().


\begin{DoxyCode}
\{
        \textcolor{keywordtype}{int} ret;
        \textcolor{keywordflow}{if}( ch<0 || ch>7 ) \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a6d58f9ac447476b4e084d7ca383f5183}{FAILURE};
        uint8\_t tx[] = \{(ch>>2)|(sgl<<1)|0x04, ch<<6, 0x00,\};
        uint8\_t rx[\hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8h_a25f003de16c08a4888b69f619d70f427}{ARRAY\_SIZE}(tx)] = \{0, \};
        \textcolor{keyword}{struct }spi\_ioc\_transfer tr = \{
                .tx\_buf = (\textcolor{keywordtype}{unsigned} long)tx,
                .rx\_buf = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})rx,
                .len = \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8h_a25f003de16c08a4888b69f619d70f427}{ARRAY\_SIZE}(tx),
                .delay\_usecs = \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_adc4674f6ea53803d98fa2ec36759e77d}{delay},
                .speed\_hz = 0,
                .bits\_per\_word = 0,
        \};

        ret = ioctl(\hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\_dev}, SPI\_IOC\_MESSAGE(1), &tr);
        \textcolor{keywordflow}{if} (ret == 1) \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a6d58f9ac447476b4e084d7ca383f5183}{FAILURE};
\textcolor{comment}{//printf("\(\backslash\)nRx = 0x%X 0x%X 0x%X\(\backslash\)n",rx[0],rx[1],rx[2]);}
\textcolor{comment}{//printf("\(\backslash\)nValor retornado pelo conversor AD:
       %d\(\backslash\)n\(\backslash\)n",rx[2]+((rx[1]&0x0F)<<8));}
        *data=(\textcolor{keywordtype}{short} int)(rx[2]+((rx[1]&0x0F)<<8));
        \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aa90cac659d18e8ef6294c7ae337f6b58}{SUCCESS};
\}
\end{DoxyCode}
\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a9fe5e6b0c564de89398a80e1689b717f}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!dac\-\_\-write@{dac\-\_\-write}}
\index{dac\-\_\-write@{dac\-\_\-write}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{dac\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t dac\-\_\-write (
\begin{DoxyParamCaption}
\item[{int}]{spi\-\_\-dev, }
\item[{uint8\-\_\-t}]{ch, }
\item[{uint8\-\_\-t}]{\-\_\-shdn, }
\item[{unsigned short int}]{data}
\end{DoxyParamCaption}
)}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a9fe5e6b0c564de89398a80e1689b717f}


Definition at line 191 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by actuate().


\begin{DoxyCode}
\{
        \textcolor{keywordtype}{int} ret;
        \textcolor{keyword}{union }txunion\{
        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} \textcolor{keywordtype}{int} data16;
        uint8\_t data8[2];
        \}txunion;
        \textcolor{keywordflow}{if}( ch<0 || ch>1 ) \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"Wrong channel value for DAC"});
        \textcolor{keywordflow}{if}( data>4095 ) \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"Value exceeded for DAC"}); 
        txunion.data16 = 0x6000|(ch<<15)|(\_shdn<<12)|(data&0x0FFF);
        uint8\_t tx[] = \{txunion.data8[0], txunion.data8[1]\};
        uint8\_t rx[\hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8h_a25f003de16c08a4888b69f619d70f427}{ARRAY\_SIZE}(tx)] = \{0, \};
        \textcolor{keyword}{struct }spi\_ioc\_transfer tr = \{
                .tx\_buf = (\textcolor{keywordtype}{unsigned} long)tx,
                .rx\_buf = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})rx,
                .len = \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8h_a25f003de16c08a4888b69f619d70f427}{ARRAY\_SIZE}(tx),
                .delay\_usecs = \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_adc4674f6ea53803d98fa2ec36759e77d}{delay},
                .speed\_hz = 0,
                .bits\_per\_word = 0,
        \};

        ret = ioctl(\hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\_dev}, SPI\_IOC\_MESSAGE(1), &tr);
        \textcolor{keywordflow}{if} (ret == 1) \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't send spi message"});
\textcolor{comment}{//printf("\(\backslash\)nRx = 0x%X 0x%X 0x%X\(\backslash\)n",rx[0],rx[1],rx[2]);}
\textcolor{comment}{//printf("\(\backslash\)nValor retornado pelo conversor AD:
       %d\(\backslash\)n\(\backslash\)n",rx[2]+((rx[1]&0x0F)<<8));}
        \textcolor{keywordflow}{return} 1;
\}
\end{DoxyCode}
\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!pabort@{pabort}}
\index{pabort@{pabort}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{pabort}]{\setlength{\rightskip}{0pt plus 5cm}int pabort (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{s}
\end{DoxyParamCaption}
)}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}


Definition at line 10 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by adc\-\_\-read(), dac\-\_\-write(), and spi\-\_\-init().


\begin{DoxyCode}
\{
        perror(s);
        \textcolor{keywordflow}{return} -1;
\}
\end{DoxyCode}
\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a3fb02c6fc5990df81645306a81291624}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!spi\-\_\-end@{spi\-\_\-end}}
\index{spi\-\_\-end@{spi\-\_\-end}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{spi\-\_\-end}]{\setlength{\rightskip}{0pt plus 5cm}void spi\-\_\-end (
\begin{DoxyParamCaption}
\item[{int}]{spi\-\_\-dev}
\end{DoxyParamCaption}
)}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a3fb02c6fc5990df81645306a81291624}


Definition at line 162 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.


\begin{DoxyCode}
\{
  close(\hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\_dev});
  \textcolor{keywordflow}{return};
\}
\end{DoxyCode}
\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a70764aca888e93b0329e7a62c9312704}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!spi\-\_\-init@{spi\-\_\-init}}
\index{spi\-\_\-init@{spi\-\_\-init}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{spi\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int spi\-\_\-init (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{mode, }
\item[{uint32\-\_\-t}]{speed, }
\item[{uint8\-\_\-t}]{cs}
\end{DoxyParamCaption}
)}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a70764aca888e93b0329e7a62c9312704}


Definition at line 99 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by devices\-\_\-init(), and main().


\begin{DoxyCode}
\{
        \textcolor{keywordtype}{int} ret = 0;
        \textcolor{keywordtype}{int} \hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\_dev};
        \textcolor{keywordtype}{char} *device;

        \textcolor{comment}{//parse\_opts(argc, argv);}
        \textcolor{keywordflow}{switch}(cs)\{
          \textcolor{keywordflow}{case} 0:
            device = \textcolor{stringliteral}{"/dev/spidev1.0"};
            \textcolor{keywordflow}{break};
          \textcolor{keywordflow}{case} 1:
            device = \textcolor{stringliteral}{"/dev/spidev1.1"};
            \textcolor{keywordflow}{break};
          \textcolor{keywordflow}{default}:
            \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"invalid chip select value"});
        \}
            
        
        spi\_dev = open(device, O\_RDWR);
        \textcolor{keywordflow}{if} (spi\_dev < 0)
                \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't open device"});
printf(\textcolor{stringliteral}{"\(\backslash\)nspi\_dev = %d\(\backslash\)n"},spi\_dev);
        \textcolor{comment}{/*}
\textcolor{comment}{         * spi mode}
\textcolor{comment}{         */}
        ret = ioctl(spi\_dev, SPI\_IOC\_WR\_MODE, &mode);
        \textcolor{keywordflow}{if} (ret == -1)
                \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't set spi mode"});

        ret = ioctl(spi\_dev, SPI\_IOC\_RD\_MODE, &mode);
        \textcolor{keywordflow}{if} (ret == -1)
                \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't get spi mode"});

        \textcolor{comment}{/*}
\textcolor{comment}{         * bits per word}
\textcolor{comment}{         */}
        ret = ioctl(spi\_dev, SPI\_IOC\_WR\_BITS\_PER\_WORD, &\hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a46a6da6b1936191571fd30b2a749f38c}{bits});
        \textcolor{keywordflow}{if} (ret == -1)
                \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't set bits per word"});

        ret = ioctl(spi\_dev, SPI\_IOC\_RD\_BITS\_PER\_WORD, &\hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a46a6da6b1936191571fd30b2a749f38c}{bits});
        \textcolor{keywordflow}{if} (ret == -1)
                \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't get bits per word"});

        \textcolor{comment}{/*}
\textcolor{comment}{         * max speed hz}
\textcolor{comment}{         */}
        ret = ioctl(spi\_dev, SPI\_IOC\_WR\_MAX\_SPEED\_HZ, &speed);
        \textcolor{keywordflow}{if} (ret == -1)
                \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't set max speed hz"});

        ret = ioctl(spi\_dev, SPI\_IOC\_RD\_MAX\_SPEED\_HZ, &speed);
        \textcolor{keywordflow}{if} (ret == -1)
                \textcolor{keywordflow}{return} \hyperlink{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_aabfca8320b0c76774f01467703e17302}{pabort}(\textcolor{stringliteral}{"can't get max speed hz"});

        \textcolor{comment}{//printf("spi mode: %d\(\backslash\)n", mode);}
        \textcolor{comment}{//printf("bits per word: %d\(\backslash\)n", bits);}
        \textcolor{comment}{//printf("max speed: %d Hz (%d KHz)\(\backslash\)n", speed, speed/1000);}

        \textcolor{keywordflow}{return} \hyperlink{CommunicationV0_2communication_8c_a4788f0a5355494bc6c13690e28f43783}{spi\_dev};
\}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a46a6da6b1936191571fd30b2a749f38c}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!bits@{bits}}
\index{bits@{bits}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{bits}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t bits = 8\hspace{0.3cm}{\ttfamily [static]}}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_a46a6da6b1936191571fd30b2a749f38c}


Definition at line 17 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by conv\-\_\-byte\-\_\-hex\-\_\-bin(), and spi\-\_\-init().

\hypertarget{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_adc4674f6ea53803d98fa2ec36759e77d}{\index{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}!delay@{delay}}
\index{delay@{delay}!spi_functions (Cópia em conflito de André Carvalho 2013-04-26).c@{spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c}}
\subsubsection[{delay}]{\setlength{\rightskip}{0pt plus 5cm}uint16\-\_\-t delay\hspace{0.3cm}{\ttfamily [static]}}}\label{spi__functions_01_07C_xC3_xB3pia_01em_01conflito_01de_01Andr_xC3_xA9_01Carvalho_012013-04-26_08_8c_adc4674f6ea53803d98fa2ec36759e77d}


Definition at line 19 of file spi\-\_\-functions (\-Cópia em conflito de André Carvalho 2013-\/04-\/26).\-c.



Referenced by adc\-\_\-read(), and dac\-\_\-write().

